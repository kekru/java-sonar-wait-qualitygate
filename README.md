# java-sonar-wait-qualitygate

Simple waiting for sonarqube quality gates to finish.  
Can be easily integrated in gradle builds.  

## Integrate in gradle

settings.gradle

```groovy
pluginManagement {
  repositories {
    maven { url 'https://jitpack.io' }
  }
}
```

build.gradle

```groovy
import de.kekru.sonarwaitqualitygate.*

buildscript {
  dependencies {
    classpath "com.github.kekru.java-sonar-wait-qualitygate:java-sonar-wait-qualitygate:<git hash or tag>"
  }
}

...

task waitForQualityGate {
  doLast {
    System.setProperty("sonar.host.url", "https://mysonar.example.com")
    System.setProperty("sonar.login", "123456789")
    new SonarWaitQualityGate().run();
  }
}
```

Run with `./gradlew sonarqube waitForQualityGate --info`

## Configuration

All properties can be set using Java system properties or environment variables, e.g.  

```bash
export sonar_host_url=https://mysonar.example.com
# or
./gradlew sonarqube waitForQualityGate -Dsonar.host.url=https://mysonar.example.com
```

You can also set system properties directly in you build.gradle, see above.

All configs:

+ `sonar.host.url` Sonarqube Server URL
+ `sonar.login` Sonarqube login token
+ `waitqualitygate.reportTaskTxtLocation` path to your "report-task.txt" file, generated by sonarqube plugin.  
  Defaults to "build/sonar/report-task.txt"
+ `waitqualitygate.timeoutSeconds` Timeout in seconds for waiting for the quality gate.  
  Defaults to 300
+ `waitqualitygate.retryIntervalSeconds` Interval in seconds for polling sonarqube while waiting for the quality gate.  
  Defaults to 10
+ `waitqualitygate.failOnFailedQualityGate` Whether to exit with an error code, if the quality gate fails.  
  Default to "true"
